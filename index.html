<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>For Kiara üíï</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json" />

  <!-- Theme colors -->
  <meta name="theme-color" content="#ff6b9d" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="For Kiara üíï" />

  <!-- Icons -->
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Dancing+Script:wght@700&display=swap" rel="stylesheet" />

  <!-- Particles.js -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    * { box-sizing: border-box; }
    body, html {
      margin: 0; padding: 0;
      font-family: 'Poppins', sans-serif;
      height: 100%;
      background: linear-gradient(-45deg, #ff9a9e, #fad0c4, #fad0c4, #ff9a9e, #a18cd1, #fbc2eb);
      background-size: 600% 600%;
      animation: gradientBG 20s ease infinite;
      color: white;
      overflow: hidden;
      touch-action: pan-x pan-y;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    #particles-js {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 1;
    }

    .app-container {
      position: relative;
      z-index: 10;
      max-width: 540px;
      margin: 0 auto;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .scroll-container {
      flex: 1;
      overflow-x: auto;
      overflow-y: hidden;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      display: flex;
      padding: 0 20px;
    }

    .section {
      min-width: 100vw;
      padding: 40px 30px;
      scroll-snap-align: start;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      opacity: 0;
      transform: translateX(100px);
      transition: all 0.8s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    .section.active {
      opacity: 1;
      transform: translateX(0);
    }

    .section h1, .section p, .section button, .section iframe, .section .subtitle {
      opacity: 0;
      transform: translateY(30px);
      animation: floatIn 1s ease forwards;
    }

    .section h1 { animation-delay: 0.3s; }
    .section p, .section .subtitle { animation-delay: 0.5s; }
    .section iframe, .section button { animation-delay: 0.7s; }

    @keyframes floatIn {
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes bouncePulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px #ff69b4; }
      50% { box-shadow: 0 0 40px #ff1493, 0 0 60px #ff69b4; }
    }

    /* Home */
    #typeText {
      font-family: 'Dancing Script', cursive;
      font-size: 2.8rem;
      line-height: 1.4;
      margin-bottom: 20px;
      position: relative;
    }

    #typeText::after {
      content: '|';
      animation: blink 1s infinite;
      color: #ff69b4;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    #home p {
      font-size: 1.3rem;
      line-height: 1.7;
      margin: 25px 0;
      animation: bouncePulse 3s infinite ease-in-out;
    }

    #countdown {
      font-size: 1.2rem;
      margin: 30px 0;
      padding: 15px;
      background: rgba(255,105,180,0.2);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      animation: glow 4s infinite;
    }

    #loveMessage {
      background: rgba(255,105,180,0.4);
      border-radius: 25px;
      padding: 30px;
      font-size: 1.6rem;
      text-align: center;
      margin-top: 30px;
      backdrop-filter: blur(15px);
      border: 2px solid rgba(255,105,180,0.6);
      animation: glow 3s infinite, bouncePulse 4s infinite;
    }

    /* Buttons */
    button {
      background: linear-gradient(45deg, #ff6b9d, #ff8ac5);
      border: none;
      border-radius: 50px;
      color: white;
      padding: 16px 32px;
      font-weight: 700;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(255,107,157,0.6);
      transition: all 0.4s ease;
      animation: bouncePulse 2s infinite;
    }

    button:hover {
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 20px 40px rgba(255,107,157,0.9);
    }

    /* Gallery */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 15px;
      margin-top: 20px;
      padding: 10px 0;
    }

    .gallery img, .gallery video {
      width: 100%;
      height: 160px;
      object-fit: cover;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(255,105,180,0.4);
      transition: all 0.5s ease;
      cursor: pointer;
    }

    .gallery img:hover, .gallery video:hover {
      transform: scale(1.1) rotate(3deg);
      box-shadow: 0 20px 40px rgba(255,20,147,0.7);
      z-index: 10;
    }

    /* Messages */
    .messages-container {
      max-height: 200px;
      overflow-y: auto;
      background: rgba(255,255,255,0.15);
      padding: 20px;
      border-radius: 25px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }

    .message {
      background: linear-gradient(135deg, #ff9a9e, #fecfef);
      color: #333;
      padding: 15px 20px;
      border-radius: 20px;
      margin: 12px 0;
      animation: floatIn 0.8s ease backwards;
      box-shadow: 0 8px 20px rgba(255,105,180,0.3);
    }

    /* Navigation */
    .bottom-nav {
      display: flex;
      justify-content: space-around;
      padding: 15px 0;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(20px);
      border-top: 1px solid rgba(255,255,255,0.2);
    }

    .nav-btn {
      background: none;
      border: none;
      color: rgba(255,255,255,0.7);
      font-size: 1rem;
      font-weight: 600;
      padding: 10px;
      position: relative;
      transition: all 0.3s ease;
    }

    .nav-btn.active {
      color: #ff69b4;
      animation: bouncePulse 1.5s infinite;
    }

    .nav-btn.active::after {
      content: 'üíñ';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.5rem;
      animation: bounce 1.5s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0) translateX(-50%); }
      50% { transform: translateY(-10px) translateX(-50%); }
    }
  </style>
</head>
<body>

<div id="particles-js"></div>

<div class="app-container">
  <div class="scroll-container" id="scrollContainer">
    <section id="home" class="section active">
      <h1 id="typeText"></h1>
      <p>Somewhere between all the little conversations and stolen smiles,<br>you quietly became my favorite feeling üòåüíï</p>
      <div id="countdown" class="countdown"></div>
      <button onclick="showLove()">One last thing‚Ä¶ ‚ù§Ô∏è</button>
      <div id="loveMessage" class="hidden">
        Kiara‚Ä¶<br><br>
        You‚Äôre not just special to me.<br>
        You‚Äôre my peace,<br>
        my joy,<br>
        my safe place.<br><br>
        <span style="font-size:2rem;">You‚Äôre home üíó</span>
      </div>
    </section>

    <section id="song" class="section">
      <div class="subtitle">This song reminds me of you‚Ä¶ press play when you‚Äôre ready üíû</div>
      <iframe
        style="border-radius:25px; box-shadow: 0 15px 40px rgba(0,0,0,0.5);"
        src="https://open.spotify.com/embed/track/0PqiJTvvmEiV3rTZcQ7SIS"
        width="100%"
        height="152"
        frameborder="0"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture">
      </iframe>
    </section>

    <section id="memories" class="section">
      <button onclick="showPassword()">Open our memories üîíüíò</button>
      <div id="passwordBox" class="hidden">
        <p class="subtitle">Enter your name to continue üòâ</p>
        <input type="text" id="passwordInput" placeholder="Your name‚Ä¶" autocomplete="off" />
        <button onclick="checkPassword()">Unlock Forever üíï</button>
      </div>
      <div id="gallerySection" class="hidden">
        <div class="subtitle">Everything you ever sent me‚Ä¶ I kept it all safe forever üíñ</div>
        <div class="gallery" id="gallery"></div>
      </div>
    </section>

    <section id="messages" class="section">
      <h2>Sweet Messages üíå</h2>
      <div class="messages-container" id="messagesContainer"></div>
      <textarea id="messageInput" placeholder="Write me a note..." rows="4"></textarea>
      <button onclick="saveMessage()">Send üíñ</button>
    </section>
  </div>

  <nav class="bottom-nav">
    <button class="nav-btn active" data-section="0">üè†</button>
    <button class="nav-btn" data-section="1">üéµ</button>
    <button class="nav-btn" data-section="2">üì∏</button>
    <button class="nav-btn" data-section="3">üíå</button>
  </nav>
</div>

<script>
  // Enhanced Particles with more hearts
  particlesJS("particles-js", {
    particles: {
      number: { value: 80, density: { enable: true, value_area: 800 } },
      color: { value: ["#ff69b4", "#ff1493", "#ffb6c1", "#ffffff"] },
      shape: { type: "heart" },
      opacity: { value: 0.8, random: true, anim: { enable: true, speed: 0.8 } },
      size: { value: 30, random: true, anim: { enable: true, speed: 4 } },
      move: {
        enable: true,
        speed: 2,
        direction: "none",
        random: true,
        straight: false,
        out_mode: "out",
        attract: { enable: true, rotateX: 600, rotateY: 1200 }
      }
    },
    interactivity: {
      detect_on: "window",
      events: {
        onhover: { enable: true, mode: "repulse" },
        onclick: { enable: true, mode: "push" },
        resize: true
      },
      modes: {
        repulse: { distance: 100, duration: 0.4 },
        push: { particles_nb: 4 }
      }
    },
    retina_detect: true
  });

  // Horizontal scroll navigation
  const scrollContainer = document.getElementById('scrollContainer');
  const navButtons = document.querySelectorAll('.nav-btn');
  const sections = document.querySelectorAll('.section');

  navButtons.forEach((btn, index) => {
    btn.addEventListener('click', () => {
      navButtons.forEach(b => b.classList.remove('active'));
      sections.forEach(s => s.classList.remove('active'));
      btn.classList.add('active');
      sections[index].classList.add('active');
      scrollContainer.scrollTo({
        left: index * window.innerWidth,
        behavior: 'smooth'
      });
      confettiBurst();
    });
  });

  // Typing effect with cursor
  const fullText = "Hey Kiara üíï\n\nI hope this finds you smiling‚Ä¶\nbecause just thinking about you does that to me every time.";
  let index = 0;
  const speed = 70;
  const typeElement = document.getElementById("typeText");
  function typeEffect() {
    if (index < fullText.length) {
      if (fullText.charAt(index) === '\n') {
        typeElement.innerHTML += "<br><br>";
      } else {
        typeElement.innerHTML += fullText.charAt(index);
      }
      index++;
      setTimeout(typeEffect, speed);
    } else {
      typeElement.innerHTML = typeElement.innerHTML.replace('|', '');
    }
  }
  setTimeout(typeEffect, 800);

  // Countdown
  function updateCountdown() {
    const now = new Date();
    const nextFriday = new Date(now);
    const daysToFriday = (5 - now.getDay() + 7) % 7 || 7;
    nextFriday.setDate(now.getDate() + daysToFriday);
    nextFriday.setHours(0,0,0,0);
    const diff = nextFriday - now;
    const days = Math.floor(diff / (1000*60*60*24));
    const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
    document.getElementById('countdown').innerHTML =
      `Just <strong>${days}</strong> days and <strong>${hours}</strong> hours until Friday‚Ä¶<br>until I get to feel you in my thoughts all over again üíï`;
  }
  updateCountdown();
  setInterval(updateCountdown, 3600000);

  // Love message + massive confetti
  function showLove() {
    const msg = document.getElementById('loveMessage');
    msg.style.display = 'block';
    setTimeout(() => msg.classList.remove('hidden'), 100);
    
    confetti({
      particleCount: 300,
      spread: 100,
      origin: { y: 0.6 },
      colors: ['#ff69b4', '#ff1493', '#ffb6c1', '#ffffff', '#f093fb']
    });
    confetti({
      particleCount: 150,
      angle: 60,
      spread: 55,
      origin: { x: 0 },
      colors: ['#ff69b4', '#ff1493']
    });
    confetti({
      particleCount: 150,
      angle: 120,
      spread: 55,
      origin: { x: 1 },
      colors: ['#ff69b4', '#ff1493']
    });
  }

  function confettiBurst() {
    confetti({
      particleCount: 100,
      spread: 70,
      origin: { y: 0.8 }
    });
  }

  // Gallery & Password (unchanged logic, just more animation)
  function showPassword() {
    document.getElementById('passwordBox').classList.remove('hidden');
    confettiBurst();
  }

  function checkPassword() {
    const input = document.getElementById('passwordInput').value.trim().toLowerCase();
    if (input === 'kiara') {
      document.getElementById('gallerySection').classList.remove('hidden');
      document.getElementById('passwordBox').style.display = 'none';
      loadGallery();
      confetti({
        particleCount: 200,
        spread: 90,
        origin: { y: 0.5 }
      });
    } else {
      alert("Hmm‚Ä¶ that doesn‚Äôt sound like my favorite person üòâ Try again!");
    }
  }

  function loadGallery() {
    const gallery = document.getElementById('gallery');
    if (gallery.children.length) return;

    for(let i=0; i<=12; i++) {
      const img = document.createElement('img');
      img.src = `assets/images/${i}.jpeg`;
      img.alt = `Memory ${i+1}`;
      img.loading = "lazy";
      img.onclick = () => openLightbox(img.src);
      gallery.appendChild(img);
    }

    const videos = ['kiara.mp4','kiara2.mp4','kiara3.mp4','kiara4.mp4'];
    videos.forEach(videoName => {
      const video = document.createElement('video');
      video.src = `assets/videos/${videoName}`;
      video.controls = true;
      video.loading = "lazy";
      gallery.appendChild(video);
    });
  }

  function openLightbox(src) {
    let lightbox = document.getElementById('lightbox');
    if(!lightbox) {
      lightbox = document.createElement('div');
      lightbox.id = 'lightbox';
      lightbox.style.cssText = `
        position:fixed;top:0;left:0;width:100vw;height:100vh;
        background:rgba(0,0,0,0.95);display:flex;justify-content:center;
        align-items:center;z-index:1000;backdrop-filter:blur(10px);
      `;
      lightbox.onclick = () => lightbox.remove();
      const img = document.createElement('img');
      img.style.cssText = 'max-width:95vw;max-height:95vh;border-radius:25px;box-shadow:0 0 50px #ff69b4;';
      img.id = 'lightbox-img';
      lightbox.appendChild(img);
      document.body.appendChild(lightbox);
    }
    document.getElementById('lightbox-img').src = src;
  }

  // Messages
  function saveMessage() {
    const input = document.getElementById('messageInput');
    const val = input.value.trim();
    if(!val) return;
    const container = document.getElementById('messagesContainer');
    const msgDiv = document.createElement('div');
    msgDiv.classList.add('message');
    msgDiv.textContent = val;
    container.appendChild(msgDiv);
    container.scrollTop = container.scrollHeight;
    input.value = '';

    let messages = JSON.parse(localStorage.getItem('kiaraMessages') || '[]');
    messages.push(val);
    localStorage.setItem('kiaraMessages', JSON.stringify(messages));

    confettiBurst();
  }

  function loadMessages() {
    let messages = JSON.parse(localStorage.getItem('kiaraMessages') || '[]');
    const container = document.getElementById('messagesContainer');
    messages.forEach((m, i) => {
      const msgDiv = document.createElement('div');
      msgDiv.classList.add('message');
      msgDiv.textContent = m;
      msgDiv.style.animationDelay = `${i * 0.1}s`;
      container.appendChild(msgDiv);
    });
  }
  loadMessages();
</script>

</body>
</html>